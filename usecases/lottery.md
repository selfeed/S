
lottery
======

中文版本
----------

现实中的彩票，往往存在很多猫腻，总有人刚好50注清空奖池，开奖不公开不透明，甚至出现开奖视频与开奖结果不一致的丑闻。实际上，这里有一种纯技术的解决方案：一种P2P的彩票方案。简单起见，这里利用比特币现有机制为基础给出一个可实际操作的方案。



比特币天生已经是公开的账本，
为了杜绝作弊，需要借鉴现实世界的公开的抽奖机制：

1: 全流程公开操作，每个人都可以看到票箱的操作；

2: 每个人把自己名字的票封好投进票箱；

3: 主持人摇一下票箱，确保票区分不出来了；

4: 嘉宾随手抓出一张票，在众人目光下拆封唱票。



我们发现实体票有下面的特征：

1: 隐秘性，无人可以提前知道其内容;

2: 可解密性，所有票最终可以拆开公布内容




借鉴实体抽奖机制，我们选中一个加密算法，用来同时提供短时间的保密与长时间的自动解密性，这个算法一定不能通过大规模并行计算而失去对绝对时间的度量性。

这个算法很简单，就是迭代执行N次sha1算法，就是这么简单！
假定投注周期为一个小时，而单次sha1最快需要1毫秒，那我们只需要迭代运算360万次，即可消耗掉这一小时。

我们定义：密钥=迭代sha1(种子，360万次）.

显而易见，这个算法总体上无法并行来优化，个人机器可能慢点，需要10小时，最快性能单线程需要1小时，银河超算来了，也需要1小时！

投注者事前必须提前花时间准备好种子与密钥。

投注者提前花一小时准备好种子和密钥，投注时在比特币转账时提供以下信息：

1: 种子，

2: 使用密钥加密后的票

投注时间结束后，大家共同进行计算，多核的彩民可以承担多张票的解密，每张票都有多个彩民复算。通过p2p的方式大家都会获得全部解密的票。

有了全部的票，根据约定的算法，比如说全部票的sha码算出中奖号码，然后举办方按照这个结果支付即可，举办方还不至于公然抵赖的。

回顾下算法，我们可以发现条件2也是不必要的，密钥也可以作为票的，只是可能丢失吉祥数字这一心灵调味料；当然我们也可以要求票主提供更多信息以便加快票的清算或者是提供更加丰富的功能；还有选民平时可以利用多核准备很多种子和密钥备用，只是要注意妥善保管，不过只要还有一个彩民的密钥没有泄露，作弊就无意义，依然有惊喜！

该机制最大的意义就是在虚拟世界中引入了绝对时间！

该机制可能被用于彩票、公益基金的回馈、赌博、定期自动解密的档案等等机制。
